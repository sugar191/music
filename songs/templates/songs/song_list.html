{% load get_item %}

<!DOCTYPE html>
<html>
<head>
    <title>Ê•ΩÊõ≤‰∏ÄË¶ß</title>
    <style>
        body {
            margin: 0;
            font-family: sans-serif;
        }
        .top-bar {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            background: #f8f8f8;
            padding: 10px;
            border-bottom: 1px solid #ccc;
            z-index: 10;
            box-sizing: border-box;
        }
        .bottom-bar {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            background: #f8f8f8;
            padding: 10px 20px;
            border-top: 1px solid #ccc;
            z-index: 10;
            box-sizing: border-box;
        }
        .bottom-bar button {
            max-width: 100%;
            box-sizing: border-box; /* „Éú„Çø„É≥ÂÜÖ„ÅÆpadding„ÇÇÂπÖ„Å´Âê´„ÇÅ„Çã */
        }
        .table-area {
            padding: 70px 10px 70px 10px; /* ‰∏ä‰∏ã„Å´‰ΩôÁôΩÁ¢∫‰øùÔºà„Éò„ÉÉ„ÉÄ„Éº„Éª„Éï„ÉÉ„Çø„Éº„ÅÆÂàÜÔºâ */
            overflow-y: auto;
            max-height: calc(100vh - 140px); /* Ê§úÁ¥¢„Éê„ÉºÔºã‰øùÂ≠ò„Éú„Çø„É≥ÂàÜ */
        }
        table {
            border-collapse: collapse;
        }
        th, td {
            padding: 8px;
            border: 1px solid #ccc;
            text-align: left;
        }
    </style>
</head>
<body>

<!-- üîç Ê§úÁ¥¢„Éï„Ç©„Éº„É†Ôºà‰∏äÈÉ®Âõ∫ÂÆöÔºâ -->
<!-- Ê§úÁ¥¢„Éï„Ç©„Éº„É†ÔºàGETÔºâ ‰∏ä„Å´Áã¨Á´ã„Åï„Åõ„Å¶ÂÆåÂÖ®„Å´Èñâ„Åò„Çã -->
<div class="top-bar">
    <form method="get" action="{% url 'song_list' %}" style="display: flex; gap: 10px;">
        <input type="text" name="q" placeholder="Ê§úÁ¥¢ÔºàÊõ≤Âêç/„Ç¢„Éº„ÉÜ„Ç£„Çπ„ÉàÔºâ" value="{{ query }}" style="flex: 1;">
        <button type="submit">Ê§úÁ¥¢</button>
    </form>
</div>

<!-- üéµ ÁÇπÊï∞‰øùÂ≠òÔºã„ÉÜ„Éº„Éñ„É´Ôºà‰∏≠Ôºâ -->
<form method="post">
    {% csrf_token %}

    <div class="table-area">
        <table>
            <thead>
                <tr>
                    <th>„Ç¢„Éº„ÉÜ„Ç£„Çπ„Éà</th>
                    <th>Ê•ΩÊõ≤Âêç</th>
                    <th>ÁÇπÊï∞</th>
                </tr>
            </thead>
            <tbody>
                {% for song in songs %}
                    <tr>
                        <td><a href="{% url 'song_list' %}?q={{ song.artist.name }}">{{ song.artist.name }}</a></td>
                        <td><a href="https://www.youtube.com/results?search_query={{ song.artist.name|urlencode }}+{{ song.title|urlencode }}" target="_blank" rel="noopener noreferrer">{{ song.title }}</a></td>
                        <td>
                            {% with form=rating_forms|get_item:song.id %}
                                {{ form.score }}
                            {% endwith %}
                        </td>
                    </tr>
                {% empty %}
                    <tr><td colspan="3">Ê•ΩÊõ≤„ÅåË¶ã„Å§„Åã„Çä„Åæ„Åõ„Çì„Åß„Åó„Åü„ÄÇ</td></tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    <!-- üíæ ‰øùÂ≠ò„Éú„Çø„É≥Ôºà‰∏ãÈÉ®Âõ∫ÂÆöÔºâ -->
    <div class="bottom-bar">
        <button type="submit">ÁÇπÊï∞„Çí‰øùÂ≠ò</button>
        <a href="{% url 'artist_ranking' %}">„É©„É≥„Ç≠„É≥„Ç∞„ÇíË¶ã„Çã</a>
    </div>
</form>

</body>
</html>